name: Playwright Tests with Qase

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          playwright install chromium
      
      - name: Run tests
        env:
          QASE_TESTOPS_API_TOKEN: ${{ secrets.QASE_API_TOKEN }}
        run: |
          pytest tests/ \
            --qase-mode=testops \
            --qase-testops-project=STPCT \
            --qase-testops-run-title="GitHub Run #${{ github.run_number }}" \
            --timeout=120 \
            --html=report.html \
            --self-contained-html \
            -v -s
      
      - name: Upload HTML report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-report
          path: report.html
      
      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results
          path: test-results/
```

4. **Commit changes**

---

## **Шаг 5: Запустите тест**

После всех коммитов тест **автоматически запустится**.

Или запустите вручную:
1. **Actions** → **Playwright Tests with Qase** (слева)
2. **Run workflow** → **Run workflow**

---

## **Шаг 6: Проверьте результаты**

### **В GitHub Actions:**
1. Откройте последний запуск в Actions
2. Раскройте **"Run tests"**
3. Прокрутите вниз - увидите таблицу:
```
============================================================
TEST STEPS SUMMARY:
============================================================
1. [16:30:15] Open CloudFX homepage - passed
2. [16:30:18] Click Account button - passed
3. [16:30:19] Fill username: user.16062@cloudfy.com - passed
...
============================================================
